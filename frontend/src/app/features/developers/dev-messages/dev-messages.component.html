<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="10px">
	<div>
		<mat-form-field class="select-project">
			<mat-label>{{'selectProject' | translate}}</mat-label>
			<mat-select [compareWith]="compareProjects" (selectionChange)="changeProject($event.value)"
						[(ngModel)]="selectedProject">
				<mat-option *ngFor="let project of projects" [value]="project">
					{{project.name}}
				</mat-option>
			</mat-select>
		</mat-form-field>
	</div>
	<div fxLayoutGap="10px" *ngIf="selectedProject">
		<input #csvInput hidden="true" type="file" onclick="this.value=null" (change)="importCSV($event)" accept=".csv"/>
		<button mat-raised-button
				color="primary"
				matTooltip="{{'importMessagesTooltip' | translate}}"
				matTooltipClass="tooltip-font"
				[disabled]="!selectedProject"
				(click)="csvInput.click()">
			{{'importMessages' | translate}}
		</button>
	</div>
</div>

<div [id]="aggregateInfoId">
	<app-aggregate-info [selectedProjectId]="selectedProjectId"></app-aggregate-info>
</div>


<div [id]="messagesTableId" fxLayout="row" fxLayoutAlign="space-evenly start">
	<div class="app-table-wrapper">
		<app-dev-messages-table
			[messages]="messages"
			[selectedRowIndex]="selectedRowIndex"
			(editEvent)="editMessage($event)"
			(formToggle)="toggleForm($event)"
			(archiveEvent)="archiveMessage($event)"
			[selectedProject]="selectedProject"></app-dev-messages-table>
	</div>

	<div *ngIf="showForm" class="form-wrapper">
		<mat-card id="form-messages" *ngIf="showForm" class="form-container mat-elevation-z4">
			<h1>{{formMode | translate}} {{'message' | translate | lowercase}}</h1>
			<mat-label *ngIf="!selectedProject" class="warning"><strong>{{'projectNotSelected' | translate}}!</strong>
			</mat-label>

			<form [formGroup]="messageParams">

				<mat-form-field class="form-field">
					<input formControlName="key"
						   placeholder="{{'key' | translate}}"
						   matInput
						   required>
					<mat-error *ngIf="messageParams.get('key').hasError('required')"
							   [innerHTML]="'messageKeyRequired' | translate">

					</mat-error>
				</mat-form-field>

				<mat-form-field>
					<input formControlName="content"
						   placeholder="{{'content' | translate}}"
						   matInput
						   required>
					<mat-error *ngIf="messageParams.get('content').hasError('required')"
							   [innerHTML]="'messageContentRequired' | translate">

					</mat-error>
				</mat-form-field>

				<mat-form-field>
			<textarea formControlName="description"
					  placeholder="{{'description' | translate}}"
					  matInput
					  cdkTextareaAutosize
					  cdkAutosizeMinRows="1"
					  cdkAutosizeMaxRows="5"></textarea>
				</mat-form-field>

				<div class="buttons-row">
					<button class="button-spacer" mat-raised-button color="accent" type="button"
							[disabled]="(!messageParams.valid || !selectedProject)"
							(click)="createMessage(messageParams)">
						{{formMode | translate}}
					</button>
					<button class="button-spacer" mat-button color="warn" type="button" (click)="cancelUpdate()">
						{{'cancel' | translate}}
					</button>
					<button mat-raised-button color="warn" type="button" (click)="clearForm(messageParams)">
						{{'clear' | translate}}
					</button>
				</div>

			</form>
		</mat-card>
	</div>
</div>

